<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>Debug Mode</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/matter-js/0.19.0/matter.min.js"></script>
  <style>
    body { margin: 0; overflow: hidden; background: #fff; }
    canvas { display: block; width: 100%; height: 100%; }
    #msg {
      position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
      font-size: 24px; font-weight: bold; color: red; pointer-events: none;
      text-align: center;
    }
  </style>
</head>
<body>
  <div id="msg">화면을 클릭하면<br>이미지 로딩을 시도합니다</div>
  <canvas id="canvas"></canvas>

  <script>
    // ========================================================
    // [진단용 설정]
    // 여기서 확장자가 .jpg인지 .png인지 .PNG인지 꼭 확인하세요.
    // ========================================================
    const FOLDER_NAME = 'icon'; // 폴더 이름
    const EXTENSION = '.png';   // 파일 확장자 (점 포함)
    const TOTAL_NUM = 15;       // 이미지 개수
    // ========================================================

    const Engine = Matter.Engine,
          Render = Matter.Render,
          Runner = Matter.Runner,
          Bodies = Matter.Bodies,
          Composite = Matter.Composite,
          Mouse = Matter.Mouse,
          MouseConstraint = Matter.MouseConstraint;

    const engine = Engine.create();
    const world = engine.world;

    const canvas = document.getElementById('canvas');
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    const render = Render.create({
      canvas: canvas,
      engine: engine,
      options: {
        width: window.innerWidth,
        height: window.innerHeight,
        wireframes: false, // 이미지를 보려면 false여야 함
        background: '#ffffff'
      }
    });

    // 벽 생성
    const wallOptions = { isStatic: true, render: { fillStyle: '#333' } };
    const ground = Bodies.rectangle(window.innerWidth/2, window.innerHeight + 50, window.innerWidth, 100, wallOptions);
    const leftWall = Bodies.rectangle(-50, window.innerHeight/2, 100, window.innerHeight, wallOptions);
    const rightWall = Bodies.rectangle(window.innerWidth+50, window.innerHeight/2, 100, window.innerHeight, wallOptions);
    Composite.add(world, [ground, leftWall, rightWall]);

    // 마우스 컨트롤
    const mouse = Mouse.create(render.canvas);
    const mouseConstraint = MouseConstraint.create(engine, {
      mouse: mouse,
      constraint: { stiffness: 0.2, render: { visible: false } }
    });
    Composite.add(world, mouseConstraint);
    render.mouse = mouse;

    function start() {
      document.getElementById('msg').style.display = 'none';

      for (let i = 1; i <= TOTAL_NUM; i++) {
        const fileName = `./${FOLDER_NAME}/${i}${EXTENSION}`;
        
        // 박스 생성
        const size = 150;
        const body = Bodies.rectangle(
          Math.random() * (window.innerWidth - 200) + 100, 
          -Math.random() * 1000 - 100, 
          size, size, 
          {
            render: {
              sprite: {
                texture: fileName, // 이미지 경로 연결
                xScale: 0.5, // 이미지 크기 조절 (필요시 수정)
                yScale: 0.5
              }
            }
          }
        );
        Composite.add(world, body);
      }
      
      Render.run(render);
      const runner = Runner.create();
      Runner.run(runner, engine);
    }

    // Matter.js 자체 렌더러가 이미지를 못 찾으면 그냥 빈 공간으로 둡니다.
    // 그래서 이미지가 안 뜨면 "경로가 틀림"을 알 수 있게 배경색을 칠하는 기능은
    // Matter.js 기본 렌더러에는 없습니다. 
    // 하지만 "분홍색/검은색 박스"라도 나오면 코드는 정상이고 이미지 경로만 틀린 겁니다.
    // 아무것도 안 나오면 -> 캔버스 오류입니다.

    document.addEventListener('click', start, { once: true });
    document.addEventListener('touchstart', start, { once: true });

  </script>
</body>
</html>
